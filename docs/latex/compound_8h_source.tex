\hypertarget{compound_8h_source}{}\doxysection{compound.\+h}
\label{compound_8h_source}\index{include/tags/compound.h@{include/tags/compound.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef INCLUDE\_TAGS\_COMPOUND\_H\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define INCLUDE\_TAGS\_COMPOUND\_H\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}base\_tag.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}nbt\_version.h"{}}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{keyword}{namespace }nbtcc \{}
\DoxyCodeLine{16 \textcolor{keyword}{class }\mbox{\hyperlink{classnbtcc_1_1TagCompound}{TagCompound}} : \textcolor{keyword}{public} \mbox{\hyperlink{classnbtcc_1_1BaseTag}{BaseTag}} \{}
\DoxyCodeLine{17  \textcolor{keyword}{public}:}
\DoxyCodeLine{23   \textcolor{keyword}{const} std::shared\_ptr<BaseTag> \mbox{\hyperlink{classnbtcc_1_1TagCompound_a1c2e78dd0de1965717ad957fc233ecea}{GetChild}}(\textcolor{keyword}{const} std::string\& key) \textcolor{keyword}{const};}
\DoxyCodeLine{24 }
\DoxyCodeLine{30   std::shared\_ptr<BaseTag> \mbox{\hyperlink{classnbtcc_1_1TagCompound_aeb5c7054c7e086b370666bbb86772d81}{GetChild}}(\textcolor{keyword}{const} std::string\& key);}
\DoxyCodeLine{31 }
\DoxyCodeLine{39   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classnbtcc_1_1TagCompound_adf0ea08d88dc21c500068f1dacc2c7c4}{SetChild}}(\textcolor{keyword}{const} std::string\& key,}
\DoxyCodeLine{40                 std::shared\_ptr<BaseTag> tag,}
\DoxyCodeLine{41                 \textcolor{keywordtype}{bool} overwrite = \textcolor{keyword}{false});}
\DoxyCodeLine{42 }
\DoxyCodeLine{48   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classnbtcc_1_1TagCompound_a1b772a2beb4106b2d5e3a7d49fc8a61b}{HasChild}}(\textcolor{keyword}{const} std::string\& key) \textcolor{keyword}{const};}
\DoxyCodeLine{49 }
\DoxyCodeLine{55   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classnbtcc_1_1TagCompound_ae7fbc68d0a0c712de048fff0bffe2923}{EraseChild}}(\textcolor{keyword}{const} std::string\& key);}
\DoxyCodeLine{56 }
\DoxyCodeLine{61   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnbtcc_1_1TagCompound_a2f7cfa11ace8c6830f423f81123d1961}{GetChildKeys}}(std::vector<std::string>* vec) \textcolor{keyword}{const};}
\DoxyCodeLine{62 }
\DoxyCodeLine{66   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnbtcc_1_1TagCompound_acdfafcf979efce5c091eae821bda0514}{Clear}}();}
\DoxyCodeLine{67 }
\DoxyCodeLine{68  \textcolor{keyword}{public}:}
\DoxyCodeLine{72   \textcolor{keyword}{inline} \mbox{\hyperlink{classnbtcc_1_1TagCompound_a13d64d72b466595771d8cad27aa50069}{TagCompound}}() : \mbox{\hyperlink{classnbtcc_1_1BaseTag}{BaseTag}}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}}::\mbox{\hyperlink{group__Tags_gga88e0f89c109ed5d0d80840a3d53b8fd5ac94dd4581bca9d508616936c86154b5e}{kTagCompound}}) \{\}}
\DoxyCodeLine{73 }
\DoxyCodeLine{77   \textcolor{keyword}{virtual} \textcolor{keyword}{inline} \mbox{\hyperlink{classnbtcc_1_1TagCompound_a44da58c27b89642eaa44da3c2418454c}{\string~TagCompound}}() \{\}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79   \textcolor{keyword}{virtual} \textcolor{keyword}{inline} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classnbtcc_1_1TagCompound_ae9de1f32468c31422d38d0d74c1ceb69}{CalculateSize}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{80     \textcolor{keywordtype}{size\_t} size = 0;}
\DoxyCodeLine{81     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : *\mbox{\hyperlink{classnbtcc_1_1BaseTag_ae8618c8fbedc773027cf32ca12a5e3e5}{\_value}}.\_value.\mbox{\hyperlink{unionnbtcc_1_1TagValueUnion_a85e161112d1c00a9f0f2baaeebdead08}{\_compound}}) \{}
\DoxyCodeLine{82       \textcolor{comment}{// child type id for 1 byte, child name length for 2 bytes and child name}}
\DoxyCodeLine{83       \textcolor{comment}{// for (child name length) byte(s).}}
\DoxyCodeLine{84       size += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}}) + \textcolor{keyword}{sizeof}(uint16\_t);}
\DoxyCodeLine{85       size += pair.first.length();}
\DoxyCodeLine{86 }
\DoxyCodeLine{87       \textcolor{comment}{// add the child body's length}}
\DoxyCodeLine{88       size += pair.second-\/>CalculateSize();}
\DoxyCodeLine{89     \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{comment}{// TAG\_End}}
\DoxyCodeLine{92     size += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}});}
\DoxyCodeLine{93     \textcolor{keywordflow}{return} size;}
\DoxyCodeLine{94   \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{keyword}{virtual} \textcolor{keyword}{inline} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classnbtcc_1_1TagCompound_a8b80c104b16296fd3b1a71ef411429e5}{WriteToBuffer}}(\textcolor{keywordtype}{char}* buffer,}
\DoxyCodeLine{97                                       \textcolor{keywordtype}{size\_t} length,}
\DoxyCodeLine{98                                       \textcolor{keywordtype}{size\_t} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{99     \textcolor{keywordtype}{size\_t} written = 0;}
\DoxyCodeLine{100     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : *\mbox{\hyperlink{classnbtcc_1_1BaseTag_ae8618c8fbedc773027cf32ca12a5e3e5}{\_value}}.\_value.\mbox{\hyperlink{unionnbtcc_1_1TagValueUnion_a85e161112d1c00a9f0f2baaeebdead08}{\_compound}}) \{}
\DoxyCodeLine{101       \textcolor{keywordflow}{if} (offset + written + \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}}) + \textcolor{keyword}{sizeof}(uint16\_t) +}
\DoxyCodeLine{102               pair.first.length() + pair.second-\/>CalculateSize() >}
\DoxyCodeLine{103           length) \{}
\DoxyCodeLine{104         \textcolor{keywordflow}{return} \mbox{\hyperlink{group__Constants_ga087c0c9b24acf33c1b03e7a1bc3f2214}{NBTCC\_WRITE\_ERROR}};}
\DoxyCodeLine{105       \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107       buffer[offset + written] = \textcolor{keyword}{static\_cast<}int8\_t\textcolor{keyword}{>}(pair.second-\/>type());}
\DoxyCodeLine{108       written += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}});}
\DoxyCodeLine{109       *\textcolor{keyword}{reinterpret\_cast<}uint16\_t*\textcolor{keyword}{>}(buffer + offset + written) =}
\DoxyCodeLine{110           htobe16(pair.first.length());}
\DoxyCodeLine{111       written += \textcolor{keyword}{sizeof}(uint16\_t);}
\DoxyCodeLine{112       memcpy(}
\DoxyCodeLine{113           buffer + offset + written, pair.first.c\_str(), pair.first.length());}
\DoxyCodeLine{114       written += pair.first.length();}
\DoxyCodeLine{115       written += pair.second-\/>WriteToBuffer(buffer, length, offset + written);}
\DoxyCodeLine{116     \}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{keywordflow}{if} (offset + written + \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}}) > length) \{}
\DoxyCodeLine{119       \textcolor{keywordflow}{return} \mbox{\hyperlink{group__Constants_ga087c0c9b24acf33c1b03e7a1bc3f2214}{NBTCC\_WRITE\_ERROR}};}
\DoxyCodeLine{120     \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     buffer[offset + written] = \textcolor{keyword}{static\_cast<}int8\_t\textcolor{keyword}{>}(\mbox{\hyperlink{group__Tags_gga88e0f89c109ed5d0d80840a3d53b8fd5a975a4c32dfab1abf9c4a9e8b75f2ad37}{TagType::kTagEnd}});}
\DoxyCodeLine{123     written += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}});}
\DoxyCodeLine{124     \textcolor{keywordflow}{return} written;}
\DoxyCodeLine{125   \}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127  \textcolor{keyword}{protected}:}
\DoxyCodeLine{128   \textcolor{keyword}{virtual} \textcolor{keyword}{inline} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classnbtcc_1_1TagCompound_ab9194a0e5b4ad3a449d4c9a287087631}{ReadBodyFromBuffer}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer,}
\DoxyCodeLine{129                                            \textcolor{keywordtype}{size\_t} length,}
\DoxyCodeLine{130                                            \textcolor{keywordtype}{size\_t} offset) \{}
\DoxyCodeLine{131     \mbox{\hyperlink{group__Utils_gaa343595fcff12d41375167ee23c31134}{PrintDebug}}(\textcolor{stringliteral}{"{}TagCompound::ReadBodyFromBuffer offset: \%zu\(\backslash\)n"{}}, offset);}
\DoxyCodeLine{132     \textcolor{keywordtype}{size\_t} next\_offset = offset;}
\DoxyCodeLine{133     \mbox{\hyperlink{classnbtcc_1_1BaseTag_aa211f661a7c3831acdee60d644539849}{BaseTag::read\_level}}++;}
\DoxyCodeLine{134     \textcolor{keywordflow}{while} (1) \{}
\DoxyCodeLine{135       \textcolor{keywordtype}{size\_t} read\_size = ReadNextTag(buffer, length, next\_offset);}
\DoxyCodeLine{136       \textcolor{keywordflow}{if} (read\_size == \mbox{\hyperlink{group__Constants_ga61d070a9afd3491ae8982e19c3be4bd9}{NBTCC\_READ\_ERROR}}) \{}
\DoxyCodeLine{137         \textcolor{keywordflow}{return} \mbox{\hyperlink{group__Constants_ga61d070a9afd3491ae8982e19c3be4bd9}{NBTCC\_READ\_ERROR}};}
\DoxyCodeLine{138       \}}
\DoxyCodeLine{139 }
\DoxyCodeLine{140       \textcolor{keywordflow}{if} (read\_size == 0) \{}
\DoxyCodeLine{141         next\_offset += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{group__Tags_ga88e0f89c109ed5d0d80840a3d53b8fd5}{TagType}});}
\DoxyCodeLine{142         \textcolor{keywordflow}{break};}
\DoxyCodeLine{143       \}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145       next\_offset += read\_size;}
\DoxyCodeLine{146     \}}
\DoxyCodeLine{147     \mbox{\hyperlink{classnbtcc_1_1BaseTag_aa211f661a7c3831acdee60d644539849}{BaseTag::read\_level}}-\/-\/;}
\DoxyCodeLine{148 }
\DoxyCodeLine{149     \textcolor{keywordflow}{return} next\_offset -\/ offset;}
\DoxyCodeLine{150   \}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152  \textcolor{keyword}{private}:}
\DoxyCodeLine{153   \textcolor{keywordtype}{size\_t} ReadNextTag(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{size\_t} length, \textcolor{keywordtype}{size\_t} offset);}
\DoxyCodeLine{154 \};}
\DoxyCodeLine{158 \}  \textcolor{comment}{// namespace nbtcc}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// INCLUDE\_TAGS\_COMPOUND\_H\_}}

\end{DoxyCode}
